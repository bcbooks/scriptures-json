{"version":3,"file":"animation_compiler.js","sourceRoot":"","sources":["../../../../../modules/@angular/compiler/src/animation/animation_compiler.ts"],"names":[],"mappings":"AAAA;;;;;;GAMG;OAGI,EAAC,gBAAgB,EAAC,MAAM,sBAAsB;OAC9C,EAAC,OAAO,EAAE,SAAS,EAAC,MAAM,gBAAgB;OAC1C,EAAC,WAAW,EAAE,iBAAiB,EAAC,MAAM,gBAAgB;OACtD,KAAK,CAAC,MAAM,sBAAsB;OAClC,EAAC,SAAS,EAAmB,aAAa,EAAE,WAAW,EAAC,MAAM,wBAAwB;OACtF,KAAK,CAAC,MAAM,iCAAiC;OAE7C,EAAoM,gBAAgB,EAAqB,MAAM,iBAAiB;OAChQ,EAAC,mBAAmB,EAAyB,mBAAmB,EAAE,wBAAwB,EAAC,MAAM,oBAAoB;AAE5H,IAAM,yBAAyB,GAC3B,IAAI,GAAG,EAA8D,CAAC;AAE1E;IACE,wCACW,IAAY,EAAS,kBAA+B,EACpD,kBAA0B,EAAS,WAAwB,EAC3D,UAAwB;QAFxB,SAAI,GAAJ,IAAI,CAAQ;QAAS,uBAAkB,GAAlB,kBAAkB,CAAa;QACpD,uBAAkB,GAAlB,kBAAkB,CAAQ;QAAS,gBAAW,GAAX,WAAW,CAAa;QAC3D,eAAU,GAAV,UAAU,CAAc;IAAG,CAAC;IACzC,qCAAC;AAAD,CAAC,AALD,IAKC;AAED;IACE,0CACW,OAA0B,EAAS,QAA0C;QAA7E,YAAO,GAAP,OAAO,CAAmB;QAAS,aAAQ,GAAR,QAAQ,CAAkC;IAAG,CAAC;IAC9F,uCAAC;AAAD,CAAC,AAHD,IAGC;AAED;IAAA;IA4CA,CAAC;IA3CC,4CAAgB,GAAhB,UAAiB,SAAmC,EAAE,QAAyB;QAE7E,IAAI,kBAAkB,GAAqC,EAAE,CAAC;QAC9D,IAAI,aAAa,GAAa,EAAE,CAAC;QACjC,IAAI,aAAa,GAAoD,EAAE,CAAC;QACxE,IAAI,aAAa,GAAG,SAAS,CAAC,IAAI,CAAC,IAAI,CAAC;QAExC,SAAS,CAAC,QAAQ,CAAC,UAAU,CAAC,OAAO,CAAC,UAAA,KAAK;YACzC,IAAI,MAAM,GAAG,mBAAmB,CAAC,KAAK,CAAC,CAAC;YACxC,IAAI,WAAW,GAAG,KAAK,CAAC,IAAI,CAAC;YAC7B,EAAE,CAAC,CAAC,MAAM,CAAC,MAAM,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC,CAAC;gBAC7B,IAAI,YAAY,GACZ,kDAA+C,WAAW,oCAAgC,CAAC;gBAC/F,MAAM,CAAC,MAAM,CAAC,OAAO,CACjB,UAAC,KAA0B,IAAO,YAAY,IAAI,OAAO,GAAG,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC;gBAC9E,aAAa,CAAC,IAAI,CAAC,YAAY,CAAC,CAAC;YACnC,CAAC;YAED,EAAE,CAAC,CAAC,aAAa,CAAC,WAAW,CAAC,CAAC,CAAC,CAAC;gBAC/B,aAAa,CAAC,IAAI,CACd,6BAA0B,WAAW,4CAAqC,aAAa,OAAG,CAAC,CAAC;YAClG,CAAC;YAAC,IAAI,CAAC,CAAC;gBACN,IAAI,WAAW,GAAM,aAAa,SAAI,KAAK,CAAC,IAAM,CAAC;gBACnD,IAAI,OAAO,GAAG,IAAI,iBAAiB,CAAC,WAAW,EAAE,WAAW,CAAC,CAAC;gBAC9D,IAAI,aAAa,GAAG,OAAO,CAAC,KAAK,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC;gBAC9C,kBAAkB,CAAC,IAAI,CAAC,aAAa,CAAC,CAAC;gBACvC,aAAa,CAAC,KAAK,CAAC,IAAI,CAAC,GAAG,aAAa,CAAC;YAC5C,CAAC;QACH,CAAC,CAAC,CAAC;QAEH,IAAI,mBAAmB,GAAG,4BAA4B,CAAC,kBAAkB,EAAE,QAAQ,CAAC,CAAC;QACrF,mBAAmB,CAAC,MAAM,CAAC,OAAO,CAAC,UAAA,KAAK,IAAM,aAAa,CAAC,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;QAEhF,EAAE,CAAC,CAAC,aAAa,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC,CAAC;YAC7B,IAAI,eAAe,GACf,2BAAyB,SAAS,CAAC,IAAI,CAAC,IAAI,6CAA0C,CAAC;YAC3F,aAAa,CAAC,OAAO,CAAC,UAAA,KAAK,IAAI,OAAA,eAAe,IAAI,SAAO,KAAO,EAAjC,CAAiC,CAAC,CAAC;YAClE,MAAM,IAAI,KAAK,CAAC,eAAe,CAAC,CAAC;QACnC,CAAC;QAED,yBAAyB,CAAC,GAAG,CAAC,SAAS,EAAE,kBAAkB,CAAC,CAAC;QAC7D,MAAM,CAAC,IAAI,gCAAgC,CAAC,mBAAmB,CAAC,OAAO,EAAE,kBAAkB,CAAC,CAAC;IAC/F,CAAC;IACH,wBAAC;AAAD,CAAC,AA5CD,IA4CC;AAED,IAAI,8BAA8B,GAAG,CAAC,CAAC,QAAQ,CAAC,SAAS,CAAC,CAAC;AAC3D,IAAI,4BAA4B,GAAG,CAAC,CAAC,QAAQ,CAAC,oBAAoB,CAAC,CAAC;AACpE,IAAI,2BAA2B,GAAG,CAAC,CAAC,QAAQ,CAAC,MAAM,CAAC,CAAC;AACrD,IAAI,+BAA+B,GAAG,2BAA2B,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;AACnF,IAAI,4BAA4B,GAAG,CAAC,CAAC,QAAQ,CAAC,cAAc,CAAC,CAAC;AAC9D,IAAI,yBAAyB,GAAG,CAAC,CAAC,QAAQ,CAAC,WAAW,CAAC,CAAC;AACxD,IAAI,qBAAqB,GAAG,CAAC,CAAC,QAAQ,CAAC,QAAQ,CAAC,CAAC;AACjD,IAAI,mBAAmB,GAAG,CAAC,CAAC,QAAQ,CAAC,WAAW,CAAC,CAAC;AAClD,IAAI,iCAAiC,GAAG,CAAC,CAAC,QAAQ,CAAC,kBAAkB,CAAC,CAAC;AACvE,IAAI,+BAA+B,GAAG,CAAC,CAAC,QAAQ,CAAC,gBAAgB,CAAC,CAAC;AACnE,IAAI,2BAA2B,GAAG,CAAC,CAAC,QAAQ,CAAC,iBAAiB,CAAC,CAAC;AAChE,IAAI,SAAS,GAAG,CAAC,CAAC,UAAU,CAAC,EAAE,CAAC,CAAC;AAEjC;IAKE,2BAAmB,aAAqB,EAAE,WAAmB;QAA1C,kBAAa,GAAb,aAAa,CAAQ;QACtC,IAAI,CAAC,UAAU,GAAG,WAAW,GAAG,UAAU,CAAC;QAC3C,IAAI,CAAC,iBAAiB,GAAG,WAAW,GAAG,SAAS,CAAC;QACjD,IAAI,CAAC,aAAa,GAAG,CAAC,CAAC,QAAQ,CAAC,IAAI,CAAC,iBAAiB,CAAC,CAAC;IAC1D,CAAC;IAED,gDAAoB,GAApB,UAAqB,GAAuB,EAAE,OAAiC;QAC7E,IAAI,SAAS,GAAU,EAAE,CAAC;QAC1B,EAAE,CAAC,CAAC,OAAO,CAAC,yBAAyB,CAAC,CAAC,CAAC;YACtC,SAAS,CAAC,IAAI,CAAC,iCAAiC,CAAC,CAAC;YAClD,OAAO,CAAC,yBAAyB,GAAG,KAAK,CAAC;QAC5C,CAAC;QAED,GAAG,CAAC,MAAM,CAAC,OAAO,CAAC,UAAA,KAAK;YACtB,SAAS,CAAC,IAAI,CACV,CAAC,CAAC,UAAU,CAAC,gBAAgB,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC,GAAG,CAAC,UAAA,GAAG,IAAI,OAAA,CAAC,GAAG,EAAE,CAAC,CAAC,OAAO,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,EAA5B,CAA4B,CAAC,CAAC,CAAC,CAAC;QAC3F,CAAC,CAAC,CAAC;QAEH,MAAM,CAAC,CAAC,CAAC,UAAU,CAAC,iBAAiB,CAAC,WAAW,CAAC,eAAe,CAAC,CAAC,CAAC,WAAW,CAAC;YAC9E,CAAC,CAAC,UAAU,CAAC,iBAAiB,CAAC,WAAW,CAAC,uBAAuB,CAAC,CAAC,CAAC,MAAM,CAAC;gBAC1E,2BAA2B,EAAE,CAAC,CAAC,UAAU,CAAC,SAAS,CAAC;aACrD,CAAC;SACH,CAAC,CAAC;IACL,CAAC;IAED,kDAAsB,GAAtB,UAAuB,GAAyB,EAAE,OAAiC;QAEjF,MAAM,CAAC,CAAC,CAAC,UAAU,CAAC,iBAAiB,CAAC,WAAW,CAAC,iBAAiB,CAAC,CAAC,CAAC,WAAW,CAAC;YAChF,CAAC,CAAC,OAAO,CAAC,GAAG,CAAC,MAAM,CAAC,EAAE,GAAG,CAAC,MAAM,CAAC,KAAK,CAAC,IAAI,EAAE,OAAO,CAAC;SACvD,CAAC,CAAC;IACL,CAAC;IAED,8CAAkB,GAAlB,UAAmB,GAAqB,EAAE,OAAiC;QAA3E,iBAUC;QATC,EAAE,CAAC,CAAC,OAAO,CAAC,mBAAmB,KAAK,GAAG,CAAC,CAAC,CAAC;YACxC,MAAM,CAAC,IAAI,CAAC,uBAAuB,CAAC,GAAG,EAAE,OAAO,CAAC,CAAC;QACpD,CAAC;QAED,IAAI,kBAAkB,GAAG,GAAG,CAAC,cAAc,CAAC,KAAK,CAAC,IAAI,EAAE,OAAO,CAAC,CAAC;QACjE,IAAI,mBAAmB,GACnB,GAAG,CAAC,SAAS,CAAC,GAAG,CAAC,UAAA,aAAa,IAAI,OAAA,aAAa,CAAC,KAAK,CAAC,KAAI,EAAE,OAAO,CAAC,EAAlC,CAAkC,CAAC,CAAC;QAC3E,MAAM,CAAC,IAAI,CAAC,kBAAkB,CAC1B,GAAG,EAAE,kBAAkB,EAAE,CAAC,CAAC,UAAU,CAAC,mBAAmB,CAAC,EAAE,OAAO,CAAC,CAAC;IAC3E,CAAC;IAED,gBAAgB;IAChB,mDAAuB,GAAvB,UAAwB,GAAqB,EAAE,OAAiC;QAAhF,iBAUC;QATC,IAAI,kBAAkB,GAAG,GAAG,CAAC,cAAc,CAAC,KAAK,CAAC,IAAI,EAAE,OAAO,CAAC,CAAC;QACjE,IAAI,mBAAmB,GAAG,GAAG,CAAC,SAAS,CAAC,GAAG,CAAC,UAAA,QAAQ,IAAI,OAAA,QAAQ,CAAC,KAAK,CAAC,KAAI,EAAE,OAAO,CAAC,EAA7B,CAA6B,CAAC,CAAC;QACvF,IAAI,aAAa,GACb,CAAC,CAAC,UAAU,CAAC,iBAAiB,CAAC,WAAW,CAAC,yBAAyB,CAAC,CAAC,CAAC,MAAM,CAAC;YAC5E,2BAA2B,EAAE,+BAA+B;YAC5D,CAAC,CAAC,UAAU,CAAC,mBAAmB,CAAC;SAClC,CAAC,CAAC;QAEP,MAAM,CAAC,IAAI,CAAC,kBAAkB,CAAC,GAAG,EAAE,kBAAkB,EAAE,aAAa,EAAE,OAAO,CAAC,CAAC;IAClF,CAAC;IAED,gBAAgB;IAChB,8CAAkB,GAAlB,UACI,GAAqB,EAAE,kBAAuB,EAAE,aAAkB,EAClE,OAAiC;QACnC,OAAO,CAAC,mBAAmB,IAAI,GAAG,CAAC,QAAQ,GAAG,GAAG,CAAC,KAAK,CAAC;QACxD,MAAM,CAAC,+BAA+B,CAAC,UAAU,CAAC,SAAS,EAAE;YAC3D,8BAA8B,EAAE,kBAAkB,EAAE,aAAa,EAAE,CAAC,CAAC,OAAO,CAAC,GAAG,CAAC,QAAQ,CAAC;YAC1F,CAAC,CAAC,OAAO,CAAC,GAAG,CAAC,KAAK,CAAC,EAAE,CAAC,CAAC,OAAO,CAAC,GAAG,CAAC,MAAM,CAAC;SAC5C,CAAC,CAAC;IACL,CAAC;IAED,kDAAsB,GAAtB,UAAuB,GAAyB,EAAE,OAAiC;QAAnF,iBAMC;QAJC,IAAI,WAAW,GAAG,GAAG,CAAC,KAAK,CAAC,GAAG,CAAC,UAAA,IAAI,IAAI,OAAA,IAAI,CAAC,KAAK,CAAC,KAAI,EAAE,OAAO,CAAC,EAAzB,CAAyB,CAAC,CAAC;QACnE,MAAM,CAAC,CAAC,CAAC,UAAU,CAAC,iBAAiB,CAAC,WAAW,CAAC,uBAAuB,CAAC,CAAC,CAAC,WAAW,CAAC;YACtF,CAAC,CAAC,UAAU,CAAC,WAAW,CAAC;SAC1B,CAAC,CAAC;IACL,CAAC;IAED,+CAAmB,GAAnB,UAAoB,GAAsB,EAAE,OAAiC;QAA7E,iBAKC;QAJC,IAAI,WAAW,GAAG,GAAG,CAAC,KAAK,CAAC,GAAG,CAAC,UAAA,IAAI,IAAI,OAAA,IAAI,CAAC,KAAK,CAAC,KAAI,EAAE,OAAO,CAAC,EAAzB,CAAyB,CAAC,CAAC;QACnE,MAAM,CAAC,CAAC,CAAC,UAAU,CAAC,iBAAiB,CAAC,WAAW,CAAC,oBAAoB,CAAC,CAAC,CAAC,WAAW,CAAC;YACnF,CAAC,CAAC,UAAU,CAAC,WAAW,CAAC;SAC1B,CAAC,CAAC;IACL,CAAC;IAED,0DAA8B,GAA9B,UACI,GAAiC,EAAE,OAAiC;QACtE,IAAI,UAAU,GAAqC,EAAE,CAAC;QACtD,eAAe,CAAC,GAAG,CAAC,CAAC,OAAO,CAAC,UAAA,KAAK;YAChC,gBAAgB,CAAC,OAAO,CAAC,KAAK,EAAE,UAAC,KAAa,EAAE,GAAW,IAAO,UAAU,CAAC,GAAG,CAAC,GAAG,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC;QAChG,CAAC,CAAC,CAAC;QACH,OAAO,CAAC,QAAQ,CAAC,aAAa,CAAC,GAAG,CAAC,SAAS,EAAE,UAAU,CAAC,CAAC;IAC5D,CAAC;IAED,yDAA6B,GAA7B,UACI,GAAgC,EAAE,OAAiC;QACrE,IAAI,KAAK,GAAG,GAAG,CAAC,SAAS,CAAC,KAAK,CAAC;QAChC,IAAI,QAAQ,GAAG,KAAK,CAAC,KAAK,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC;QACvC,EAAE,CAAC,CAAC,sBAAsB,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC;YACrC,OAAO,CAAC,mBAAmB,GAAqB,QAAQ,CAAC;QAC3D,CAAC;QAED,OAAO,CAAC,mBAAmB,GAAG,CAAC,CAAC;QAChC,OAAO,CAAC,yBAAyB,GAAG,IAAI,CAAC;QAEzC,IAAI,wBAAwB,GAAmB,EAAE,CAAC;QAElD,GAAG,CAAC,YAAY,CAAC,OAAO,CAAC,UAAA,WAAW;YAClC,wBAAwB,CAAC,IAAI,CACzB,4BAA4B,CAAC,4BAA4B,EAAE,WAAW,CAAC,SAAS,CAAC;iBAC5E,GAAG,CAAC,4BAA4B,CAAC,yBAAyB,EAAE,WAAW,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC;YAE5F,EAAE,CAAC,CAAC,WAAW,CAAC,SAAS,IAAI,SAAS,CAAC,CAAC,CAAC;gBACvC,OAAO,CAAC,QAAQ,CAAC,aAAa,CAAC,WAAW,CAAC,SAAS,CAAC,CAAC;YACxD,CAAC;YAED,EAAE,CAAC,CAAC,WAAW,CAAC,OAAO,IAAI,SAAS,CAAC,CAAC,CAAC;gBACrC,OAAO,CAAC,QAAQ,CAAC,aAAa,CAAC,WAAW,CAAC,OAAO,CAAC,CAAC;YACtD,CAAC;QACH,CAAC,CAAC,CAAC;QAEH,IAAI,mBAAmB,GAAG,GAAG,CAAC,SAAS,CAAC,KAAK,CAAC,IAAI,EAAE,OAAO,CAAC,CAAC;QAE7D,IAAI,+BAA+B,GAAG,wBAAwB,CAAC,MAAM,CAAC,UAAC,CAAC,EAAE,CAAC,IAAK,OAAA,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,EAAP,CAAO,CAAC,CAAC;QACzF,IAAI,YAAY,GACZ,qBAAqB,CAAC,MAAM,CAAC,CAAC,CAAC,SAAS,CAAC,CAAC,GAAG,CAAC,+BAA+B,CAAC,CAAC;QAEnF,IAAI,aAAa,GAAG,qBAAqB,CAAC,GAAG,CAAC,mBAAmB,CAAC,CAAC,MAAM,EAAE,CAAC;QAC5E,IAAI,aAAa,GAAG,mBAAmB,CAAC,GAAG,CAAC,CAAC,CAAC,OAAO,CAAC,OAAO,CAAC,mBAAmB,CAAC,CAAC,CAAC,MAAM,EAAE,CAAC;QAE7F,MAAM,CAAC,IAAI,CAAC,CAAC,MAAM,CAAC,YAAY,EAAE,CAAC,aAAa,EAAE,aAAa,CAAC,CAAC,CAAC;IACpE,CAAC;IAED,+CAAmB,GAAnB,UAAoB,GAAsB,EAAE,OAAiC;QAA7E,iBAyGC;QAxGC,sEAAsE;QACtE,GAAG,CAAC,iBAAiB,CAAC,OAAO,CAAC,UAAA,GAAG,IAAI,OAAA,GAAG,CAAC,KAAK,CAAC,KAAI,EAAE,OAAO,CAAC,EAAxB,CAAwB,CAAC,CAAC;QAE/D,8DAA8D;QAC9D,OAAO,CAAC,QAAQ,CAAC,aAAa,CAAC,aAAa,EAAE,EAAE,CAAC,CAAC;QAElD,IAAI,UAAU,GAAkB,EAAE,CAAC;QACnC,UAAU,CAAC,IAAI,CAAC,2BAA2B;aACtB,UAAU,CACP,uBAAuB,EACvB;YACE,8BAA8B,EAAE,CAAC,CAAC,OAAO,CAAC,IAAI,CAAC,aAAa,CAAC;YAC7D,yBAAyB,CAAC,MAAM,CAAC,CAAC,CAAC,OAAO,CAAC,WAAW,CAAC,CAAC;SACzD,CAAC;aACL,MAAM,EAAE,CAAC,CAAC;QAG/B,UAAU,CAAC,IAAI,CAAC,2BAA2B,CAAC,GAAG,CAAC,SAAS,CAAC,CAAC,UAAU,EAAE,CAAC,CAAC;QACzE,UAAU,CAAC,IAAI,CAAC,qBAAqB,CAAC,GAAG,CAAC,CAAC,CAAC,SAAS,CAAC,CAAC,UAAU,EAAE,CAAC,CAAC;QACrE,UAAU,CAAC,IAAI,CAAC,mBAAmB,CAAC,GAAG,CAAC,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,CAAC,UAAU,EAAE,CAAC,CAAC;QAEpE,UAAU,CAAC,IAAI,CACX,4BAA4B,CAAC,GAAG,CAAC,IAAI,CAAC,aAAa,CAAC,GAAG,CAAC,CAAC,CAAC,OAAO,CAAC,aAAa,CAAC,CAAC,CAAC;aAC7E,UAAU,EAAE,CAAC,CAAC;QAEvB,UAAU,CAAC,IAAI,CACX,iCAAiC,CAAC,GAAG,CAAC,IAAI,CAAC,aAAa,CAAC,GAAG,CAAC,4BAA4B,CAAC,CAAC;aACtF,UAAU,EAAE,CAAC,CAAC;QAEvB,UAAU,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,MAAM,CACxB,iCAAiC,CAAC,MAAM,CAAC,CAAC,CAAC,SAAS,CAAC,EACrD,CAAC,iCAAiC,CAAC,GAAG,CAAC,4BAA4B,CAAC,CAAC,MAAM,EAAE,CAAC,CAAC,CAAC,CAAC;QAErF,UAAU,CAAC,IAAI,CACX,+BAA+B,CAAC,GAAG,CAAC,IAAI,CAAC,aAAa,CAAC,GAAG,CAAC,yBAAyB,CAAC,CAAC;aACjF,UAAU,EAAE,CAAC,CAAC;QAEvB,UAAU,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,MAAM,CACxB,+BAA+B,CAAC,MAAM,CAAC,CAAC,CAAC,SAAS,CAAC,EACnD,CAAC,+BAA+B,CAAC,GAAG,CAAC,4BAA4B,CAAC,CAAC,MAAM,EAAE,CAAC,CAAC,CAAC,CAAC;QAEnF,IAAI,gBAAgB,GAAG,CAAC,CAAC,UAAU,CAAC,iBAAiB,CAAC,WAAW,CAAC,YAAY,CAAC,CAAC,CAAC;QAEjF,kEAAkE;QAClE,mEAAmE;QACnE,yCAAyC;QACzC,UAAU,CAAC,IAAI,CAAC,gBAAgB;aACX,MAAM,CAAC;YACN,8BAA8B,EAAE,+BAA+B;YAC/D,CAAC,CAAC,UAAU,CAAC,iBAAiB,CAAC,WAAW,CAAC,WAAW,CAAC,CAAC;iBACnD,MAAM,CAAC,CAAC,iCAAiC,CAAC,CAAC;SACjD,CAAC;aACD,MAAM,EAAE,CAAC,CAAC;QAE/B,GAAG,CAAC,gBAAgB,CAAC,OAAO,CAAC,UAAA,QAAQ,IAAI,OAAA,UAAU,CAAC,IAAI,CAAC,QAAQ,CAAC,KAAK,CAAC,KAAI,EAAE,OAAO,CAAC,CAAC,EAA9C,CAA8C,CAAC,CAAC;QAEzF,wEAAwE;QACxE,uDAAuD;QACvD,UAAU,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,MAAM,CACxB,qBAAqB,CAAC,MAAM,CAAC,CAAC,CAAC,SAAS,CAAC,EACzC,CAAC,qBAAqB;iBAChB,GAAG,CAAC,CAAC,CAAC,UAAU,CAAC,iBAAiB,CAAC,WAAW,CAAC,mBAAmB,CAAC,CAAC,CAAC,WAAW,CAAC,EAAE,CAAC,CAAC;iBACrF,MAAM,EAAE,CAAC,CAAC,CAAC,CAAC;QAEtB,2DAA2D;QAC3D,2DAA2D;QAC3D,wCAAwC;QACxC,UAAU,CAAC,IAAI,CACX,qBAAqB;aAChB,UAAU,CACP,QAAQ,EACR,CAAC,CAAC,CAAC,EAAE,CACD,EAAE,EACF,CAAC,gBAAgB;qBACX,MAAM,CAAC;oBACN,8BAA8B,EAAE,+BAA+B;oBAC/D,CAAC,CAAC,UAAU,CAAC,iBAAiB,CAAC,WAAW,CAAC,2BAA2B,CAAC,CAAC;yBACnE,MAAM,CAAC;wBACN,iCAAiC,EAAE,+BAA+B;qBACnE,CAAC;iBACP,CAAC;qBACD,MAAM,EAAE,CAAC,CAAC,CAAC,CAAC;aACzB,MAAM,EAAE,CAAC,CAAC;QAEnB,UAAU,CAAC,IAAI,CAAC,2BAA2B;aACtB,UAAU,CACP,gBAAgB,EAChB;YACE,8BAA8B,EAAE,CAAC,CAAC,OAAO,CAAC,IAAI,CAAC,aAAa,CAAC;YAC7D,qBAAqB,EAAE,mBAAmB;YAC1C,4BAA4B,EAAE,yBAAyB;SACxD,CAAC;aACL,MAAM,EAAE,CAAC,CAAC;QAE/B,MAAM,CAAC,CAAC,CAAC,EAAE,CACP;YACE,IAAI,CAAC,CAAC,OAAO,CACT,2BAA2B,CAAC,IAAI,EAChC,CAAC,CAAC,UAAU,CAAC,iBAAiB,CAAC,WAAW,CAAC,OAAO,CAAC,EAAE,CAAC,CAAC,CAAC,YAAY,CAAC,CAAC,CAAC;YAC3E,IAAI,CAAC,CAAC,OAAO,CAAC,8BAA8B,CAAC,IAAI,EAAE,CAAC,CAAC,YAAY,CAAC;YAClE,IAAI,CAAC,CAAC,OAAO,CAAC,4BAA4B,CAAC,IAAI,EAAE,CAAC,CAAC,YAAY,CAAC;YAChE,IAAI,CAAC,CAAC,OAAO,CAAC,yBAAyB,CAAC,IAAI,EAAE,CAAC,CAAC,YAAY,CAAC;SAC9D,EACD,UAAU,CAAC,CAAC;IAClB,CAAC;IAED,iCAAK,GAAL,UAAM,GAAiB;QACrB,IAAI,OAAO,GAAG,IAAI,wBAAwB,EAAE,CAAC;QAC7C,IAAI,WAAW,GAAG,GAAG,CAAC,KAAK,CAAC,IAAI,EAAE,OAAO,CAAC,CAAC,UAAU,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;QACvE,IAAI,UAAU,GAAG,CAAC,CAAC,QAAQ,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;QAE7C,IAAI,SAAS,GAAU,EAAE,CAAC;QAC1B,gBAAgB,CAAC,OAAO,CACpB,OAAO,CAAC,QAAQ,CAAC,MAAM,EAAE,UAAC,KAA8B,EAAE,SAAiB;YACzE,IAAI,aAAa,GAAG,SAAS,CAAC;YAC9B,EAAE,CAAC,CAAC,SAAS,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC;gBACrB,IAAI,UAAQ,GAAU,EAAE,CAAC;gBACzB,gBAAgB,CAAC,OAAO,CAAC,KAAK,EAAE,UAAC,KAAa,EAAE,GAAW;oBACzD,UAAQ,CAAC,IAAI,CAAC,CAAC,GAAG,EAAE,CAAC,CAAC,OAAO,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC;gBACzC,CAAC,CAAC,CAAC;gBACH,aAAa,GAAG,CAAC,CAAC,UAAU,CAAC,UAAQ,CAAC,CAAC;YACzC,CAAC;YACD,SAAS,CAAC,IAAI,CAAC,CAAC,SAAS,EAAE,aAAa,CAAC,CAAC,CAAC;QAC7C,CAAC,CAAC,CAAC;QAEP,IAAI,qBAAqB,GAAG,IAAI,CAAC,aAAa,CAAC,GAAG,CAAC,CAAC,CAAC,UAAU,CAAC,SAAS,CAAC,CAAC,CAAC,UAAU,EAAE,CAAC;QACzF,MAAM,CAAC,IAAI,8BAA8B,CACrC,IAAI,CAAC,aAAa,EAAE,qBAAqB,EAAE,IAAI,CAAC,iBAAiB,EAAE,WAAW,EAAE,UAAU,CAAC,CAAC;IAClG,CAAC;IACH,wBAAC;AAAD,CAAC,AA1QD,IA0QC;AAED;IAAA;QACE,aAAQ,GAAG,IAAI,yBAAyB,EAAE,CAAC;QAC3C,wBAAmB,GAAqB,IAAI,CAAC;QAC7C,8BAAyB,GAAG,KAAK,CAAC;QAClC,wBAAmB,GAAG,CAAC,CAAC;IAC1B,CAAC;IAAD,+BAAC;AAAD,CAAC,AALD,IAKC;AAED;IAAA;QACU,YAAO,GAAuD,EAAE,CAAC;IAQ3E,CAAC;IAPC,sBAAI,6CAAM;aAAV,cAAe,MAAM,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC,CAAC;;;OAAA;IACrC,iDAAa,GAAb,UAAc,IAAY,EAAE,KAA+C;QAA/C,qBAA+C,GAA/C,YAA+C;QACzE,IAAI,aAAa,GAAG,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC;QACvC,EAAE,CAAC,CAAC,OAAO,CAAC,aAAa,CAAC,CAAC,CAAC,CAAC;YAC3B,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,GAAG,KAAK,CAAC;QAC7B,CAAC;IACH,CAAC;IACH,gCAAC;AAAD,CAAC,AATD,IASC;AAED,sCAAsC,KAAmB,EAAE,cAAsB;IAC/E,IAAI,iBAAiB,GAAG,CAAC,CAAC,OAAO,CAAC,WAAW,CAAC,CAAC;IAC/C,MAAM,CAAC,CAAC,cAAc,CAAC,CAAC,CAAC;QACvB,KAAK,WAAW;YACd,MAAM,CAAC,KAAK,CAAC,MAAM,CAAC,iBAAiB,CAAC,CAAC;QAEzC,KAAK,SAAS;YACZ,MAAM,CAAC,CAAC,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC;QAEzB;YACE,MAAM,CAAC,KAAK,CAAC,MAAM,CAAC,CAAC,CAAC,OAAO,CAAC,cAAc,CAAC,CAAC,CAAC;IACnD,CAAC;AACH,CAAC;AAED,gCAAgC,IAAkB;IAChD,+DAA+D;IAC/D,kEAAkE;IAClE,EAAE,CAAC,CAAC,IAAI,YAAY,gBAAgB,IAAI,IAAI,CAAC,QAAQ,GAAG,CAAC,IAAI,IAAI,CAAC,SAAS,CAAC,MAAM,IAAI,CAAC,CAAC,CAAC,CAAC;QACxF,IAAI,OAAO,GAAG,eAAe,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;QACpD,IAAI,OAAO,GAAG,eAAe,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;QACpD,MAAM,CAAC,gBAAgB,CAAC,OAAO,CAAC,OAAO,CAAC,IAAI,gBAAgB,CAAC,OAAO,CAAC,OAAO,CAAC,CAAC;IAChF,CAAC;IACD,MAAM,CAAC,KAAK,CAAC;AACf,CAAC;AAED,yBAAyB,GAAQ;IAC/B,MAAM,CAAC,GAAG,CAAC,MAAM,CAAC,MAAM,CAAC;AAC3B,CAAC;AAED,sCACI,kBAAoD,EACpD,QAAyB;IAC3B,IAAI,OAAO,GAAG,IAAI,iCAAiC,CAAC,kBAAkB,CAAC,CAAC;IACxE,CAAC,CAAC,gBAAgB,CAAC,OAAO,EAAE,QAAQ,CAAC,CAAC;IACtC,MAAM,CAAC,IAAI,iCAAiC,CAAC,OAAO,CAAC,OAAO,EAAE,OAAO,CAAC,MAAM,CAAC,CAAC;AAChF,CAAC;AAED;IACE,2CAAmB,OAA0B,EAAS,MAA6B;QAAhE,YAAO,GAAP,OAAO,CAAmB;QAAS,WAAM,GAAN,MAAM,CAAuB;IAAG,CAAC;IACzF,wCAAC;AAAD,CAAC,AAFD,IAEC;AAED;IAKE,2CAAY,UAA4C;QAHjD,WAAM,GAA0B,EAAE,CAAC;QACnC,YAAO,GAAsB,EAAE,CAAC;QAGrC,IAAI,CAAC,kBAAkB,GAAG,IAAI,CAAC,4BAA4B,CAAC,UAAU,CAAC,CAAC;IAC1E,CAAC;IAEO,wEAA4B,GAApC,UAAqC,UAA4C;QAE/E,IAAI,GAAG,GAA6B,EAAE,CAAC;QACvC,UAAU,CAAC,OAAO,CAAC,UAAA,KAAK,IAAM,GAAG,CAAC,KAAK,CAAC,IAAI,CAAC,GAAG,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC;QACzD,MAAM,CAAC,GAAG,CAAC;IACb,CAAC;IAEO,8EAAkC,GAA1C,UACI,SAAsC,EAAE,UAA6B,EACrE,iBAAuC,EAAE,WAAoB;QAFjE,iBAgCC;QA7BC,IAAI,uBAAuB,GAA6B,EAAE,CAAC;QAC3D,SAAS,CAAC,OAAO,CAAC,UAAA,KAAK;YACrB,EAAE,CAAC,CAAC,KAAK,CAAC,IAAI,IAAI,CAAC,CAAC,mBAAmB,CAAC,SAAS,CAAC,CAAC,CAAC;gBAClD,IAAI,WAAW,GAAG,KAAK,CAAC,IAAI,CAAC;gBAC7B,EAAE,CAAC,CAAC,SAAS,CAAC,iBAAiB,CAAC,WAAW,CAAC,CAAC,CAAC,CAAC,CAAC;oBAC9C,uBAAuB,CAAC,WAAW,CAAC,GAAG,IAAI,CAAC;gBAC9C,CAAC;gBAAC,IAAI,CAAC,CAAC;oBACN,KAAI,CAAC,MAAM,CAAC,IAAI,CACZ,IAAI,mBAAmB,CAAC,0CAAwC,WAAa,CAAC,CAAC,CAAC;gBACtF,CAAC;YACH,CAAC;QACH,CAAC,CAAC,CAAC;QAEH,UAAU,CAAC,OAAO,CAAC,UAAA,MAAM;YACvB,EAAE,CAAC,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC,CAAC,IAAI,GAAG,CAAC,CAAC,CAAC;gBAC1B,IAAI,oBAAoB,GAAG,wBAAwB,CAAC,MAAM,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC,CAAC,EAAE,KAAI,CAAC,MAAM,CAAC,CAAC;gBACxF,IAAI,WAAW,GAAG,oBAAoB,CAAC,IAAI,CAAC;gBAC5C,IAAI,iBAAiB,GAAG,oBAAoB,CAAC,KAAK,CAAC;gBACnD,EAAE,CAAC,CAAC,CAAC,iBAAiB,CAAC,WAAW,CAAC,CAAC,CAAC,CAAC;oBACpC,KAAI,CAAC,MAAM,CAAC,IAAI,CAAC,IAAI,mBAAmB,CACpC,sCAAmC,WAAW,GAAG,aAAa,GAAG,EAAE,4CAAuC,WAAW,MAAG,CAAC,CAAC,CAAC;gBACjI,CAAC;gBAAC,IAAI,CAAC,EAAE,CAAC,CAAC,CAAC,uBAAuB,CAAC,WAAW,CAAC,CAAC,CAAC,CAAC;oBACjD,KAAI,CAAC,MAAM,CAAC,IAAI,CAAC,IAAI,mBAAmB,CACpC,2BAAyB,WAAW,SAAI,iBAAiB,0CAAqC,WAAW,2CAAwC,CAAC,CAAC,CAAC;gBAC1J,CAAC;gBAAC,IAAI,CAAC,CAAC;oBACN,KAAI,CAAC,OAAO,CAAC,IAAI,CAAC,oBAAoB,CAAC,CAAC;gBAC1C,CAAC;YACH,CAAC;QACH,CAAC,CAAC,CAAC;IACL,CAAC;IAED,wDAAY,GAAZ,UAAa,GAAiB,EAAE,GAAQ;QACtC,IAAI,CAAC,kCAAkC,CACnC,GAAG,CAAC,MAAM,EAAE,GAAG,CAAC,OAAO,EAAE,IAAI,CAAC,kBAAkB,EAAE,KAAK,CAAC,CAAC;QAE7D,IAAI,kBAAkB,GAClB,GAAG,CAAC,UAAU,CAAC,IAAI,CAAC,UAAA,SAAS,IAAI,OAAA,SAAS,CAAC,SAAS,CAAC,WAAW,EAA/B,CAA+B,CAAC,CAAC;QACtE,EAAE,CAAC,CAAC,kBAAkB,CAAC,CAAC,CAAC;YACvB,IAAI,yBAAyB,GAAG,yBAAyB,CAAC,GAAG,CAAC,kBAAkB,CAAC,SAAS,CAAC,CAAC;YAC5F,EAAE,CAAC,CAAC,yBAAyB,CAAC,CAAC,CAAC;gBAC9B,IAAI,CAAC,kCAAkC,CACnC,kBAAkB,CAAC,cAAc,EAAE,kBAAkB,CAAC,UAAU,EAChE,IAAI,CAAC,4BAA4B,CAAC,yBAAyB,CAAC,EAAE,IAAI,CAAC,CAAC;YAC1E,CAAC;QACH,CAAC;QAED,CAAC,CAAC,gBAAgB,CAAC,IAAI,EAAE,GAAG,CAAC,QAAQ,CAAC,CAAC;IACzC,CAAC;IAED,iEAAqB,GAArB,UAAsB,GAA0B,EAAE,GAAQ;QACxD,CAAC,CAAC,gBAAgB,CAAC,IAAI,EAAE,GAAG,CAAC,QAAQ,CAAC,CAAC;IACzC,CAAC;IAED,sDAAU,GAAV,UAAW,GAAoB,EAAE,GAAQ,IAAQ,CAAC;IAClD,0DAAc,GAAd,UAAe,GAAmB,EAAE,GAAQ,IAAQ,CAAC;IACrD,qDAAS,GAAT,UAAU,GAAc,EAAE,GAAQ,IAAQ,CAAC;IAC3C,0DAAc,GAAd,UAAe,GAAmB,EAAE,GAAQ,IAAQ,CAAC;IACrD,qDAAS,GAAT,UAAU,GAAc,EAAE,GAAQ,IAAQ,CAAC;IAC3C,0DAAc,GAAd,UAAe,GAAmB,EAAE,GAAQ,IAAQ,CAAC;IACrD,0DAAc,GAAd,UAAe,GAAmB,EAAE,GAAQ,IAAQ,CAAC;IACrD,yDAAa,GAAb,UAAc,GAAkB,EAAE,GAAQ,IAAQ,CAAC;IACnD,kEAAsB,GAAtB,UAAuB,GAAgC,EAAE,GAAQ,IAAQ,CAAC;IAC1E,gEAAoB,GAApB,UAAqB,GAA8B,EAAE,GAAQ,IAAQ,CAAC;IACxE,wCAAC;AAAD,CAAC,AAlFD,IAkFC","sourcesContent":["/**\n * @license\n * Copyright Google Inc. All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://angular.io/license\n */\n\nimport {CompileDirectiveMetadata} from '../compile_metadata';\nimport {StringMapWrapper} from '../facade/collection';\nimport {isBlank, isPresent} from '../facade/lang';\nimport {Identifiers, resolveIdentifier} from '../identifiers';\nimport * as o from '../output/output_ast';\nimport {ANY_STATE, AnimationOutput, DEFAULT_STATE, EMPTY_STATE} from '../private_import_core';\nimport * as t from '../template_parser/template_ast';\n\nimport {AnimationAst, AnimationAstVisitor, AnimationEntryAst, AnimationGroupAst, AnimationKeyframeAst, AnimationSequenceAst, AnimationStateAst, AnimationStateDeclarationAst, AnimationStateTransitionAst, AnimationStepAst, AnimationStylesAst} from './animation_ast';\nimport {AnimationParseError, ParsedAnimationResult, parseAnimationEntry, parseAnimationOutputName} from './animation_parser';\n\nconst animationCompilationCache =\n    new Map<CompileDirectiveMetadata, CompiledAnimationTriggerResult[]>();\n\nexport class CompiledAnimationTriggerResult {\n  constructor(\n      public name: string, public statesMapStatement: o.Statement,\n      public statesVariableName: string, public fnStatement: o.Statement,\n      public fnVariable: o.Expression) {}\n}\n\nexport class CompiledComponentAnimationResult {\n  constructor(\n      public outputs: AnimationOutput[], public triggers: CompiledAnimationTriggerResult[]) {}\n}\n\nexport class AnimationCompiler {\n  compileComponent(component: CompileDirectiveMetadata, template: t.TemplateAst[]):\n      CompiledComponentAnimationResult {\n    var compiledAnimations: CompiledAnimationTriggerResult[] = [];\n    var groupedErrors: string[] = [];\n    var triggerLookup: {[key: string]: CompiledAnimationTriggerResult} = {};\n    var componentName = component.type.name;\n\n    component.template.animations.forEach(entry => {\n      var result = parseAnimationEntry(entry);\n      var triggerName = entry.name;\n      if (result.errors.length > 0) {\n        var errorMessage =\n            `Unable to parse the animation sequence for \"${triggerName}\" due to the following errors:`;\n        result.errors.forEach(\n            (error: AnimationParseError) => { errorMessage += '\\n-- ' + error.msg; });\n        groupedErrors.push(errorMessage);\n      }\n\n      if (triggerLookup[triggerName]) {\n        groupedErrors.push(\n            `The animation trigger \"${triggerName}\" has already been registered on \"${componentName}\"`);\n      } else {\n        var factoryName = `${componentName}_${entry.name}`;\n        var visitor = new _AnimationBuilder(triggerName, factoryName);\n        var compileResult = visitor.build(result.ast);\n        compiledAnimations.push(compileResult);\n        triggerLookup[entry.name] = compileResult;\n      }\n    });\n\n    var validatedProperties = _validateAnimationProperties(compiledAnimations, template);\n    validatedProperties.errors.forEach(error => { groupedErrors.push(error.msg); });\n\n    if (groupedErrors.length > 0) {\n      var errorMessageStr =\n          `Animation parsing for ${component.type.name} has failed due to the following errors:`;\n      groupedErrors.forEach(error => errorMessageStr += `\\n- ${error}`);\n      throw new Error(errorMessageStr);\n    }\n\n    animationCompilationCache.set(component, compiledAnimations);\n    return new CompiledComponentAnimationResult(validatedProperties.outputs, compiledAnimations);\n  }\n}\n\nvar _ANIMATION_FACTORY_ELEMENT_VAR = o.variable('element');\nvar _ANIMATION_DEFAULT_STATE_VAR = o.variable('defaultStateStyles');\nvar _ANIMATION_FACTORY_VIEW_VAR = o.variable('view');\nvar _ANIMATION_FACTORY_RENDERER_VAR = _ANIMATION_FACTORY_VIEW_VAR.prop('renderer');\nvar _ANIMATION_CURRENT_STATE_VAR = o.variable('currentState');\nvar _ANIMATION_NEXT_STATE_VAR = o.variable('nextState');\nvar _ANIMATION_PLAYER_VAR = o.variable('player');\nvar _ANIMATION_TIME_VAR = o.variable('totalTime');\nvar _ANIMATION_START_STATE_STYLES_VAR = o.variable('startStateStyles');\nvar _ANIMATION_END_STATE_STYLES_VAR = o.variable('endStateStyles');\nvar _ANIMATION_COLLECTED_STYLES = o.variable('collectedStyles');\nvar EMPTY_MAP = o.literalMap([]);\n\nclass _AnimationBuilder implements AnimationAstVisitor {\n  private _fnVarName: string;\n  private _statesMapVarName: string;\n  private _statesMapVar: any;\n\n  constructor(public animationName: string, factoryName: string) {\n    this._fnVarName = factoryName + '_factory';\n    this._statesMapVarName = factoryName + '_states';\n    this._statesMapVar = o.variable(this._statesMapVarName);\n  }\n\n  visitAnimationStyles(ast: AnimationStylesAst, context: _AnimationBuilderContext): o.Expression {\n    var stylesArr: any[] = [];\n    if (context.isExpectingFirstStyleStep) {\n      stylesArr.push(_ANIMATION_START_STATE_STYLES_VAR);\n      context.isExpectingFirstStyleStep = false;\n    }\n\n    ast.styles.forEach(entry => {\n      stylesArr.push(\n          o.literalMap(StringMapWrapper.keys(entry).map(key => [key, o.literal(entry[key])])));\n    });\n\n    return o.importExpr(resolveIdentifier(Identifiers.AnimationStyles)).instantiate([\n      o.importExpr(resolveIdentifier(Identifiers.collectAndResolveStyles)).callFn([\n        _ANIMATION_COLLECTED_STYLES, o.literalArr(stylesArr)\n      ])\n    ]);\n  }\n\n  visitAnimationKeyframe(ast: AnimationKeyframeAst, context: _AnimationBuilderContext):\n      o.Expression {\n    return o.importExpr(resolveIdentifier(Identifiers.AnimationKeyframe)).instantiate([\n      o.literal(ast.offset), ast.styles.visit(this, context)\n    ]);\n  }\n\n  visitAnimationStep(ast: AnimationStepAst, context: _AnimationBuilderContext): o.Expression {\n    if (context.endStateAnimateStep === ast) {\n      return this._visitEndStateAnimation(ast, context);\n    }\n\n    var startingStylesExpr = ast.startingStyles.visit(this, context);\n    var keyframeExpressions =\n        ast.keyframes.map(keyframeEntry => keyframeEntry.visit(this, context));\n    return this._callAnimateMethod(\n        ast, startingStylesExpr, o.literalArr(keyframeExpressions), context);\n  }\n\n  /** @internal */\n  _visitEndStateAnimation(ast: AnimationStepAst, context: _AnimationBuilderContext): o.Expression {\n    var startingStylesExpr = ast.startingStyles.visit(this, context);\n    var keyframeExpressions = ast.keyframes.map(keyframe => keyframe.visit(this, context));\n    var keyframesExpr =\n        o.importExpr(resolveIdentifier(Identifiers.balanceAnimationKeyframes)).callFn([\n          _ANIMATION_COLLECTED_STYLES, _ANIMATION_END_STATE_STYLES_VAR,\n          o.literalArr(keyframeExpressions)\n        ]);\n\n    return this._callAnimateMethod(ast, startingStylesExpr, keyframesExpr, context);\n  }\n\n  /** @internal */\n  _callAnimateMethod(\n      ast: AnimationStepAst, startingStylesExpr: any, keyframesExpr: any,\n      context: _AnimationBuilderContext) {\n    context.totalTransitionTime += ast.duration + ast.delay;\n    return _ANIMATION_FACTORY_RENDERER_VAR.callMethod('animate', [\n      _ANIMATION_FACTORY_ELEMENT_VAR, startingStylesExpr, keyframesExpr, o.literal(ast.duration),\n      o.literal(ast.delay), o.literal(ast.easing)\n    ]);\n  }\n\n  visitAnimationSequence(ast: AnimationSequenceAst, context: _AnimationBuilderContext):\n      o.Expression {\n    var playerExprs = ast.steps.map(step => step.visit(this, context));\n    return o.importExpr(resolveIdentifier(Identifiers.AnimationSequencePlayer)).instantiate([\n      o.literalArr(playerExprs)\n    ]);\n  }\n\n  visitAnimationGroup(ast: AnimationGroupAst, context: _AnimationBuilderContext): o.Expression {\n    var playerExprs = ast.steps.map(step => step.visit(this, context));\n    return o.importExpr(resolveIdentifier(Identifiers.AnimationGroupPlayer)).instantiate([\n      o.literalArr(playerExprs)\n    ]);\n  }\n\n  visitAnimationStateDeclaration(\n      ast: AnimationStateDeclarationAst, context: _AnimationBuilderContext): void {\n    var flatStyles: {[key: string]: string | number} = {};\n    _getStylesArray(ast).forEach(entry => {\n      StringMapWrapper.forEach(entry, (value: string, key: string) => { flatStyles[key] = value; });\n    });\n    context.stateMap.registerState(ast.stateName, flatStyles);\n  }\n\n  visitAnimationStateTransition(\n      ast: AnimationStateTransitionAst, context: _AnimationBuilderContext): any {\n    var steps = ast.animation.steps;\n    var lastStep = steps[steps.length - 1];\n    if (_isEndStateAnimateStep(lastStep)) {\n      context.endStateAnimateStep = <AnimationStepAst>lastStep;\n    }\n\n    context.totalTransitionTime = 0;\n    context.isExpectingFirstStyleStep = true;\n\n    var stateChangePreconditions: o.Expression[] = [];\n\n    ast.stateChanges.forEach(stateChange => {\n      stateChangePreconditions.push(\n          _compareToAnimationStateExpr(_ANIMATION_CURRENT_STATE_VAR, stateChange.fromState)\n              .and(_compareToAnimationStateExpr(_ANIMATION_NEXT_STATE_VAR, stateChange.toState)));\n\n      if (stateChange.fromState != ANY_STATE) {\n        context.stateMap.registerState(stateChange.fromState);\n      }\n\n      if (stateChange.toState != ANY_STATE) {\n        context.stateMap.registerState(stateChange.toState);\n      }\n    });\n\n    var animationPlayerExpr = ast.animation.visit(this, context);\n\n    var reducedStateChangesPrecondition = stateChangePreconditions.reduce((a, b) => a.or(b));\n    var precondition =\n        _ANIMATION_PLAYER_VAR.equals(o.NULL_EXPR).and(reducedStateChangesPrecondition);\n\n    var animationStmt = _ANIMATION_PLAYER_VAR.set(animationPlayerExpr).toStmt();\n    var totalTimeStmt = _ANIMATION_TIME_VAR.set(o.literal(context.totalTransitionTime)).toStmt();\n\n    return new o.IfStmt(precondition, [animationStmt, totalTimeStmt]);\n  }\n\n  visitAnimationEntry(ast: AnimationEntryAst, context: _AnimationBuilderContext): any {\n    // visit each of the declarations first to build the context state map\n    ast.stateDeclarations.forEach(def => def.visit(this, context));\n\n    // this should always be defined even if the user overrides it\n    context.stateMap.registerState(DEFAULT_STATE, {});\n\n    var statements: o.Statement[] = [];\n    statements.push(_ANIMATION_FACTORY_VIEW_VAR\n                        .callMethod(\n                            'cancelActiveAnimation',\n                            [\n                              _ANIMATION_FACTORY_ELEMENT_VAR, o.literal(this.animationName),\n                              _ANIMATION_NEXT_STATE_VAR.equals(o.literal(EMPTY_STATE))\n                            ])\n                        .toStmt());\n\n\n    statements.push(_ANIMATION_COLLECTED_STYLES.set(EMPTY_MAP).toDeclStmt());\n    statements.push(_ANIMATION_PLAYER_VAR.set(o.NULL_EXPR).toDeclStmt());\n    statements.push(_ANIMATION_TIME_VAR.set(o.literal(0)).toDeclStmt());\n\n    statements.push(\n        _ANIMATION_DEFAULT_STATE_VAR.set(this._statesMapVar.key(o.literal(DEFAULT_STATE)))\n            .toDeclStmt());\n\n    statements.push(\n        _ANIMATION_START_STATE_STYLES_VAR.set(this._statesMapVar.key(_ANIMATION_CURRENT_STATE_VAR))\n            .toDeclStmt());\n\n    statements.push(new o.IfStmt(\n        _ANIMATION_START_STATE_STYLES_VAR.equals(o.NULL_EXPR),\n        [_ANIMATION_START_STATE_STYLES_VAR.set(_ANIMATION_DEFAULT_STATE_VAR).toStmt()]));\n\n    statements.push(\n        _ANIMATION_END_STATE_STYLES_VAR.set(this._statesMapVar.key(_ANIMATION_NEXT_STATE_VAR))\n            .toDeclStmt());\n\n    statements.push(new o.IfStmt(\n        _ANIMATION_END_STATE_STYLES_VAR.equals(o.NULL_EXPR),\n        [_ANIMATION_END_STATE_STYLES_VAR.set(_ANIMATION_DEFAULT_STATE_VAR).toStmt()]));\n\n    var RENDER_STYLES_FN = o.importExpr(resolveIdentifier(Identifiers.renderStyles));\n\n    // before we start any animation we want to clear out the starting\n    // styles from the element's style property (since they were placed\n    // there at the end of the last animation\n    statements.push(RENDER_STYLES_FN\n                        .callFn([\n                          _ANIMATION_FACTORY_ELEMENT_VAR, _ANIMATION_FACTORY_RENDERER_VAR,\n                          o.importExpr(resolveIdentifier(Identifiers.clearStyles))\n                              .callFn([_ANIMATION_START_STATE_STYLES_VAR])\n                        ])\n                        .toStmt());\n\n    ast.stateTransitions.forEach(transAst => statements.push(transAst.visit(this, context)));\n\n    // this check ensures that the animation factory always returns a player\n    // so that the onDone callback can be used for tracking\n    statements.push(new o.IfStmt(\n        _ANIMATION_PLAYER_VAR.equals(o.NULL_EXPR),\n        [_ANIMATION_PLAYER_VAR\n             .set(o.importExpr(resolveIdentifier(Identifiers.NoOpAnimationPlayer)).instantiate([]))\n             .toStmt()]));\n\n    // once complete we want to apply the styles on the element\n    // since the destination state's values should persist once\n    // the animation sequence has completed.\n    statements.push(\n        _ANIMATION_PLAYER_VAR\n            .callMethod(\n                'onDone',\n                [o.fn(\n                    [],\n                    [RENDER_STYLES_FN\n                         .callFn([\n                           _ANIMATION_FACTORY_ELEMENT_VAR, _ANIMATION_FACTORY_RENDERER_VAR,\n                           o.importExpr(resolveIdentifier(Identifiers.prepareFinalAnimationStyles))\n                               .callFn([\n                                 _ANIMATION_START_STATE_STYLES_VAR, _ANIMATION_END_STATE_STYLES_VAR\n                               ])\n                         ])\n                         .toStmt()])])\n            .toStmt());\n\n    statements.push(_ANIMATION_FACTORY_VIEW_VAR\n                        .callMethod(\n                            'queueAnimation',\n                            [\n                              _ANIMATION_FACTORY_ELEMENT_VAR, o.literal(this.animationName),\n                              _ANIMATION_PLAYER_VAR, _ANIMATION_TIME_VAR,\n                              _ANIMATION_CURRENT_STATE_VAR, _ANIMATION_NEXT_STATE_VAR\n                            ])\n                        .toStmt());\n\n    return o.fn(\n        [\n          new o.FnParam(\n              _ANIMATION_FACTORY_VIEW_VAR.name,\n              o.importType(resolveIdentifier(Identifiers.AppView), [o.DYNAMIC_TYPE])),\n          new o.FnParam(_ANIMATION_FACTORY_ELEMENT_VAR.name, o.DYNAMIC_TYPE),\n          new o.FnParam(_ANIMATION_CURRENT_STATE_VAR.name, o.DYNAMIC_TYPE),\n          new o.FnParam(_ANIMATION_NEXT_STATE_VAR.name, o.DYNAMIC_TYPE)\n        ],\n        statements);\n  }\n\n  build(ast: AnimationAst): CompiledAnimationTriggerResult {\n    var context = new _AnimationBuilderContext();\n    var fnStatement = ast.visit(this, context).toDeclStmt(this._fnVarName);\n    var fnVariable = o.variable(this._fnVarName);\n\n    var lookupMap: any[] = [];\n    StringMapWrapper.forEach(\n        context.stateMap.states, (value: {[key: string]: string}, stateName: string) => {\n          var variableValue = EMPTY_MAP;\n          if (isPresent(value)) {\n            let styleMap: any[] = [];\n            StringMapWrapper.forEach(value, (value: string, key: string) => {\n              styleMap.push([key, o.literal(value)]);\n            });\n            variableValue = o.literalMap(styleMap);\n          }\n          lookupMap.push([stateName, variableValue]);\n        });\n\n    var compiledStatesMapExpr = this._statesMapVar.set(o.literalMap(lookupMap)).toDeclStmt();\n    return new CompiledAnimationTriggerResult(\n        this.animationName, compiledStatesMapExpr, this._statesMapVarName, fnStatement, fnVariable);\n  }\n}\n\nclass _AnimationBuilderContext {\n  stateMap = new _AnimationBuilderStateMap();\n  endStateAnimateStep: AnimationStepAst = null;\n  isExpectingFirstStyleStep = false;\n  totalTransitionTime = 0;\n}\n\nclass _AnimationBuilderStateMap {\n  private _states: {[key: string]: {[prop: string]: string | number}} = {};\n  get states() { return this._states; }\n  registerState(name: string, value: {[prop: string]: string | number} = null): void {\n    var existingEntry = this._states[name];\n    if (isBlank(existingEntry)) {\n      this._states[name] = value;\n    }\n  }\n}\n\nfunction _compareToAnimationStateExpr(value: o.Expression, animationState: string): o.Expression {\n  var emptyStateLiteral = o.literal(EMPTY_STATE);\n  switch (animationState) {\n    case EMPTY_STATE:\n      return value.equals(emptyStateLiteral);\n\n    case ANY_STATE:\n      return o.literal(true);\n\n    default:\n      return value.equals(o.literal(animationState));\n  }\n}\n\nfunction _isEndStateAnimateStep(step: AnimationAst): boolean {\n  // the final animation step is characterized by having only TWO\n  // keyframe values and it must have zero styles for both keyframes\n  if (step instanceof AnimationStepAst && step.duration > 0 && step.keyframes.length == 2) {\n    var styles1 = _getStylesArray(step.keyframes[0])[0];\n    var styles2 = _getStylesArray(step.keyframes[1])[0];\n    return StringMapWrapper.isEmpty(styles1) && StringMapWrapper.isEmpty(styles2);\n  }\n  return false;\n}\n\nfunction _getStylesArray(obj: any): {[key: string]: any}[] {\n  return obj.styles.styles;\n}\n\nfunction _validateAnimationProperties(\n    compiledAnimations: CompiledAnimationTriggerResult[],\n    template: t.TemplateAst[]): AnimationPropertyValidationOutput {\n  var visitor = new _AnimationTemplatePropertyVisitor(compiledAnimations);\n  t.templateVisitAll(visitor, template);\n  return new AnimationPropertyValidationOutput(visitor.outputs, visitor.errors);\n}\n\nexport class AnimationPropertyValidationOutput {\n  constructor(public outputs: AnimationOutput[], public errors: AnimationParseError[]) {}\n}\n\nclass _AnimationTemplatePropertyVisitor implements t.TemplateAstVisitor {\n  private _animationRegistry: {[key: string]: boolean};\n  public errors: AnimationParseError[] = [];\n  public outputs: AnimationOutput[] = [];\n\n  constructor(animations: CompiledAnimationTriggerResult[]) {\n    this._animationRegistry = this._buildCompileAnimationLookup(animations);\n  }\n\n  private _buildCompileAnimationLookup(animations: CompiledAnimationTriggerResult[]):\n      {[key: string]: boolean} {\n    var map: {[key: string]: boolean} = {};\n    animations.forEach(entry => { map[entry.name] = true; });\n    return map;\n  }\n\n  private _validateAnimationInputOutputPairs(\n      inputAsts: t.BoundElementPropertyAst[], outputAsts: t.BoundEventAst[],\n      animationRegistry: {[key: string]: any}, isHostLevel: boolean): void {\n    var detectedAnimationInputs: {[key: string]: boolean} = {};\n    inputAsts.forEach(input => {\n      if (input.type == t.PropertyBindingType.Animation) {\n        var triggerName = input.name;\n        if (isPresent(animationRegistry[triggerName])) {\n          detectedAnimationInputs[triggerName] = true;\n        } else {\n          this.errors.push(\n              new AnimationParseError(`Couldn't find an animation entry for ${triggerName}`));\n        }\n      }\n    });\n\n    outputAsts.forEach(output => {\n      if (output.name[0] == '@') {\n        var normalizedOutputData = parseAnimationOutputName(output.name.substr(1), this.errors);\n        let triggerName = normalizedOutputData.name;\n        let triggerEventPhase = normalizedOutputData.phase;\n        if (!animationRegistry[triggerName]) {\n          this.errors.push(new AnimationParseError(\n              `Couldn't find the corresponding ${isHostLevel ? 'host-level ' : '' }animation trigger definition for (@${triggerName})`));\n        } else if (!detectedAnimationInputs[triggerName]) {\n          this.errors.push(new AnimationParseError(\n              `Unable to listen on (@${triggerName}.${triggerEventPhase}) because the animation trigger [@${triggerName}] isn't being used on the same element`));\n        } else {\n          this.outputs.push(normalizedOutputData);\n        }\n      }\n    });\n  }\n\n  visitElement(ast: t.ElementAst, ctx: any): any {\n    this._validateAnimationInputOutputPairs(\n        ast.inputs, ast.outputs, this._animationRegistry, false);\n\n    var componentOnElement: t.DirectiveAst =\n        ast.directives.find(directive => directive.directive.isComponent);\n    if (componentOnElement) {\n      let cachedComponentAnimations = animationCompilationCache.get(componentOnElement.directive);\n      if (cachedComponentAnimations) {\n        this._validateAnimationInputOutputPairs(\n            componentOnElement.hostProperties, componentOnElement.hostEvents,\n            this._buildCompileAnimationLookup(cachedComponentAnimations), true);\n      }\n    }\n\n    t.templateVisitAll(this, ast.children);\n  }\n\n  visitEmbeddedTemplate(ast: t.EmbeddedTemplateAst, ctx: any): any {\n    t.templateVisitAll(this, ast.children);\n  }\n\n  visitEvent(ast: t.BoundEventAst, ctx: any): any {}\n  visitBoundText(ast: t.BoundTextAst, ctx: any): any {}\n  visitText(ast: t.TextAst, ctx: any): any {}\n  visitNgContent(ast: t.NgContentAst, ctx: any): any {}\n  visitAttr(ast: t.AttrAst, ctx: any): any {}\n  visitDirective(ast: t.DirectiveAst, ctx: any): any {}\n  visitReference(ast: t.ReferenceAst, ctx: any): any {}\n  visitVariable(ast: t.VariableAst, ctx: any): any {}\n  visitDirectiveProperty(ast: t.BoundDirectivePropertyAst, ctx: any): any {}\n  visitElementProperty(ast: t.BoundElementPropertyAst, ctx: any): any {}\n}\n\ninterface DecoratorInvocation {\n  type: Function;\n  args?: any[];\n}\n"]}